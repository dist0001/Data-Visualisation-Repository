<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
  </head>
  <body>
    <div id="vis"></div>
    <script type="text/javascript">
      const spec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "width": 800,
        "height": 600,
        "projection": {
          "type": "identity",
          "reflectY": true
        },
        "layer": [
          // Graticule layer using your specific file
          {
            "data": {
              "url": "ne_110m_graticules_30.json",
              "format": { "type": "topojson", "feature": "ne_110m_graticules_30" }
            },
            "mark": {
              "type": "geoshape",
              "fill": null,
              "stroke": "gray",
              "strokeWidth": 0.5,
              "opacity": 0.5
            }
          },
          // Main map layer
          {
            "data": {
              "url": "business_map.json",
              "format": { "type": "topojson", "feature": "business_map" }
            },
            "mark": {
              "type": "geoshape",
              "stroke": "white",
              "strokeWidth": 0.5
            },
            "encoding": {
              "color": {
                "condition": {
                  "test": "isValid(datum.properties.scaledLogCount)",
                  "field": "properties.scaledLogCount",
                  "type": "quantitative",
                  "scale": { "scheme": "blues" }
                },
                "value": "#eeeeee"
              },
              "tooltip": [
                { "field": "properties.suburb", "type": "nominal", "title": "Suburb" },
                { "field": "properties.scaledLogCount", "type": "quantitative", "title": "Scaled Log Count" }
              ]
            }
          }
        ]
      };

      vegaEmbed('#vis', spec);
    </script>
  </body>
</html>